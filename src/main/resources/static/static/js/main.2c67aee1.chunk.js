(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),c=n(7),o=n.n(c),s=(n(13),n(3)),r=n(4),l=n(6),d=n(5),u=(n(14),n(8)),g=n.n(u),j=n(0),h="Init",p="Reading",f="Closed",b="Canceled",S="Canceling",m="Execute Cancel",O=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e)).customSetState=function(e,t){i.state.isMounted&&i.setState(e,t)},i.fetchData=function(){console.log("Request created!",i.props),fetch(i.props.link,{method:"GET",headers:{"Content-Type":"application/x-ndjson",Accept:"application/x-ndjson"}}).then((function(e){return g()(e.body)})).then((function(e){var t=e.getReader();i.customSetState({readingState:p,readableStream:e,reader:t}),t.closed.then((function(){i.customSetState({readingState:f})})).catch((function(e){i.customSetState({readingState:b})})),i.dataRead(t)})).catch((function(e){return console.log(e)}))},i.setCancel=function(){i.state.readingState===p&&i.customSetState({readingState:S})},i.cancelStream=function(e){i.state.readingState===S&&i.state.readableStream&&i.state.reader?(i.customSetState({readingState:m}),i.state.reader.releaseLock(),i.state.readableStream.cancel("Canceled").then((function(){return console.log("Canceled promise!")}))):e&&e()},i.dataRead=function(e){e.read().then((function(t){t.value&&i.customSetState({data:t.value}),t.done||i.cancelStream((function(){return i.dataRead(e)}))}))},i.injectPoisionPill=function(e){i.customSetState({isMounted:!1,readingState:S},e)},i.profile=function(e,t){return Object(j.jsxs)("div",{children:[Object(j.jsx)("span",{children:" Id:"}),Object(j.jsxs)("span",{children:[" ",e.id]}),Object(j.jsx)("span",{children:" Percent:"}),Object(j.jsxs)("span",{children:[" ",e.pong," % "]}),Object(j.jsx)("span",{children:" TimeMs:"}),Object(j.jsxs)("span",{children:[" ",e.timeMs]}),Object(j.jsx)("span",{children:" Reading State:"}),Object(j.jsxs)("span",{children:[" ",t]})]})},i.state={data:{},readingState:h,readableStream:null,reader:null,isMounted:!1},i}return Object(r.a)(n,[{key:"componentDidMount",value:function(){console.log("componentDidMount",this.props),this.setState({isMounted:!0}),this.fetchData()}},{key:"componentWillUnmount",value:function(){console.log("componentWillUnmount",this.props)}},{key:"render",value:function(){return Object(j.jsx)("div",{children:this.state.data.id?this.profile(this.state.data,this.state.readingState):"No Data"})}}]),n}(a.a.Component),x=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var i;return Object(s.a)(this,n),(i=t.call(this,e)).setCancel=function(){i.state.pingPongRef.current.setCancel()},i.injectPoisionPill=function(e){i.state.pingPongRef.current.injectPoisionPill(e)},i.initPingPong=function(){if(i.state.pingPongRef)i.injectPoisionPill((function(){i.setState({pingPong:null,pingPongRef:null})}));else{var e=a.a.createRef(),t=Object(j.jsx)(O,{ref:e,link:i.props.link});i.setState({pingPong:t,pingPongRef:e})}return t},i.setExecute=function(){i.initPingPong()},i.state={pingPong:null,pingPongRef:null},i}return Object(r.a)(n,[{key:"componentDidMount",value:function(){this.initPingPong()}},{key:"componentDidUpdate",value:function(){this.state.pingPong||this.initPingPong()}},{key:"render",value:function(){return console.log("reloading!",this.state),Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{children:this.state.pingPong?this.state.pingPong:""}),Object(j.jsx)("div",{id:"container"}),Object(j.jsxs)("div",{style:{height:"4vh",display:"flex",flexDirection:"row"},children:[Object(j.jsx)("button",{onClick:this.setExecute,children:"press me!"}),Object(j.jsx)("button",{onClick:this.setCancel,children:"Cancel!"})]})]})}}]),n}(a.a.Component);var P=function(){return Object(j.jsx)("div",{children:Object(j.jsx)("header",{className:"App-header",children:Object(j.jsxs)("div",{children:[Array(3).fill().map((function(e,t){return Object(j.jsx)(x,{link:"/ping?delayMsLow=0&delayMsHigh=5000&times=100"},t)})),Object(j.jsx)("br",{}),Array(3).fill().map((function(e,t){return Object(j.jsx)(x,{link:"/load?delayMsLow=20&delayMsHigh=100&times=101"},t)}))]})})})},v=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),i(e),a(e),c(e),o(e)}))};o.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(P,{})}),document.getElementById("root")),v()}},[[17,1,2]]]);
//# sourceMappingURL=main.2c67aee1.chunk.js.map